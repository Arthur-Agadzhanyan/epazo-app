{"version":3,"sources":["pages/CreatePage/create.module.scss","pages/CreatePage/CreatePage.js","hooks/http.hook.js"],"names":["module","exports","CreatePage","history","useHistory","auth","useContext","AuthContext","useState","image","setImage","title","setTitle","text","setText","description","setDescription","request","useHttp","useEffect","window","M","updateTextFields","pressHandler","e","a","preventDefault","length","alert","imgUrl","Authorization","token","data","push","post","_id","className","s","container","onSubmit","input_container","htmlFor","placeholder","id","type","value","onChange","target","required","textarea_label","event","editor","getData","textarea","ClassicEditor","name","btn","loading","setLoading","error","setError","useCallback","url","method","body","headers","JSON","stringify","fetch","res","json","ok","Error","message","clearError"],"mappings":"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","file":"static/js/11.28459b2a.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"create_container__3Nq-9\",\"input_container\":\"create_input_container__1dV9O\",\"textarea\":\"create_textarea__1Vyxl\",\"btn\":\"create_btn__1wpdt\"};","import React, { useEffect, useState, useContext} from 'react';\r\nimport s from './create.module.scss'\r\nimport { useHttp } from '../../hooks/http.hook';\r\nimport { AuthContext } from '../../context/AuthContext';\r\nimport { useHistory } from 'react-router-dom';\r\nimport CKEditor from '@ckeditor/ckeditor5-react';\r\nimport ClassicEditor from '@ckeditor/ckeditor5-build-classic';\r\n\r\nexport const CreatePage = () => {\r\n    const history = useHistory()\r\n    const auth = useContext(AuthContext)\r\n    const [image, setImage] = useState('');\r\n    const [title, setTitle] = useState('');\r\n    const [text, setText] = useState('');\r\n    const [description, setDescription] = useState('');\r\n    const {request} = useHttp() \r\n    useEffect(() => {\r\n        window.M.updateTextFields()\r\n    }, [])\r\n\r\n    const pressHandler = async (e)=>{\r\n        e.preventDefault()\r\n            try{\r\n                if(description.length >=216){\r\n                    alert('Описание не должно быть длиннее 215 символов')\r\n                }else{\r\n                    const data = await request('/api/post/generate','POST',{imgUrl: image,title: title,text: text,description: description},{\r\n                        Authorization: `Bearer ${auth.token}`// в параметре headers мы передаём поле Authorization в котором указываем токен для того чтобы приложение понимало что пользователь авторизирован\r\n                    })\r\n                    \r\n                    history.push(`/posts/${data.post._id}`)\r\n                }\r\n                \r\n            }catch(e){}\r\n        \r\n    }\r\n\r\n    const changeText = ( event, editor ) => {\r\n        const data = editor.getData();\r\n        setText(data)\r\n    }\r\n\r\n    return (\r\n        <>\r\n        <div className={`row ${s.container}`}>\r\n            <div className={`col l6 offset-l3 col m8 offset-m2 col s12`}>\r\n                <form onSubmit={pressHandler}>\r\n                    <div className={`input-field ${s.input_container}`}>\r\n                        <label htmlFor=\"title\">Введите Url Картинки</label>\r\n                        <input\r\n                            placeholder=\"Картинка\"\r\n                            className=\"validate\"\r\n                            id=\"image\"\r\n                            type=\"text\"\r\n                            value={image}\r\n                            onChange={e => setImage(e.target.value)}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className={`input-field ${s.input_container}`}>\r\n                        <label htmlFor=\"title\">Введите Заголовок</label>\r\n                        <input\r\n                            placeholder=\"Заголовок\"\r\n                            className=\"validate\"\r\n                            id=\"title\"\r\n                            type=\"text\"\r\n                            value={title}\r\n                            onChange={e => setTitle(e.target.value)}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className={`input-field ${s.input_container}`}>\r\n                        <label htmlFor=\"description\">Введите Описание</label>\r\n                        <input\r\n                            placeholder=\"Описание\"\r\n                            className=\"validate\"\r\n                            id=\"description\"\r\n                            type=\"text\"\r\n                            value={description}\r\n                            onChange={e => setDescription(e.target.value)}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className={`input-field ${s.input_container}`}>\r\n                        <label htmlFor=\"text\" className = {s.textarea_label}>Введите Текст поста</label>\r\n                        {/* <textarea\r\n                        className = {s.textarea}\r\n                            placeholder=\"Текст поста\"\r\n                            \r\n                            rows=\"10\"\r\n                            cols=\"45\"\r\n                            id=\"text\"\r\n                            type=\"text\"\r\n                            value={text}\r\n                            onChange={e => setText(e.target.value)}\r\n                            required\r\n                        ></textarea> */}\r\n                        <CKEditor onChange={changeText} className={s.textarea} editor={ ClassicEditor } name='text' value={text} required/>\r\n                    </div>\r\n                    <button type='submit' className={s.btn}>Submit</button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n        </>\r\n    );\r\n}\r\n\r\n","import { useState, useCallback } from 'react';\r\n\r\nexport const useHttp = () => {\r\n    const [loading, setLoading] = useState(false)\r\n    const [error, setError] = useState(null)\r\n    const request = useCallback(async (url, method = 'GET', body = null, headers = {}) => {\r\n        setLoading(true)\r\n        try {\r\n            \r\n            if (body) {\r\n                body = JSON.stringify(body)\r\n                headers['Content-Type'] = 'application/json'\r\n            }\r\n\r\n            const res = await fetch(url, { method, body, headers })\r\n            const data = await res.json()\r\n\r\n            if (!res.ok) {\r\n                throw new Error(data.message || 'Что-то пошло не так')\r\n            }\r\n            setLoading(false)\r\n            return data\r\n        } catch (e) {\r\n            setLoading(false)\r\n            setError(e.message)\r\n            throw e\r\n        }\r\n    },[])\r\n    const clearError = useCallback(() => setError(null), [])\r\n    return { loading, request, error, clearError }\r\n}\r\n\r\n"],"sourceRoot":""}